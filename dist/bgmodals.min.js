angular.module("bg.modals",[]),function(){function a(a,b,c,d){var e=this.bgmId||d.getId();this.close=function(){d.accept(e)},b.$on("bgm:open",function(c,d){d===e&&(a.addClass("bgm-open"),b.$emit("bgm:mask"))}),b.$on("bgm:close",function(c,d){d===e&&(a.removeClass("bgm-open"),b.$emit("bgm:unmask"))}),b.$on("bgm:closeall",function(b,c){a.removeClass("bgm-open")}),b.$on("bgm:toggle",function(b,c){c===e&&a.toggleClass("bgm-open")})}function b(){return{scope:!0,controllerAs:"bgmAlert",bindToController:{title:"@bgmTitle",bgmId:"@",gotIt:"@bgmOkText"},restrict:"E",transclude:!0,require:"^bgmModals",templateUrl:"/templates/bgmAlert.html",controller:["$element","$rootScope","$transclude","bgModals",a]}}angular.module("bg.modals").directive("bgmAlert",b)}(),function(){function a(a,b){}function b(){return{scope:{},restrict:"E",transclude:!0,templateUrl:"/templates/bgmButtons.html",controller:a}}angular.module("bg.modals").directive("bgmButtons",b)}(),function(){function a(a,b,c,d){var e=this.bgmId||d.getId();this.reject=function(){d.reject(e)},this.accept=function(){d.accept(e)},b.$on("bgm:open",function(c,d){d===e&&(a.addClass("bgm-open"),b.$emit("bgm:mask"))}),b.$on("bgm:close",function(c,d){d===e&&(a.removeClass("bgm-open"),b.$emit("bgm:unmask"))}),b.$on("bgm:closeall",function(b,c){a.removeClass("bgm-open")}),b.$on("bgm:toggle",function(b,c){c===e&&a.toggleClass("bgm-open")})}function b(){return{scope:!0,controllerAs:"bgmConfirm",bindToController:{title:"@bgmTitle",bgmId:"@",yep:"@bgmYepText",nope:"@bgmNopeText"},restrict:"E",transclude:!0,require:"^bgmModals",templateUrl:"/templates/bgmConfirm.html",controller:["$element","$rootScope","$transclude","bgModals",a]}}angular.module("bg.modals").directive("bgmConfirm",b)}(),function(){function a(a,b,c,d){var e=this.bgmId||d.getId();c(function(b){for(var c=a.find("main"),d=0;d<b.length;d++)"BGM-BUTTONS"===b[d].tagName?a.append(b[d]):c.append(b[d])}),this.close=function(){b.$emit("bgm:rejected",e),b.$emit("bgm:close",e)},b.$on("bgm:open",function(c,d){d===e&&(a.addClass("bgm-open"),b.$emit("bgm:mask"))}),b.$on("bgm:close",function(c,d){d===e&&(a.removeClass("bgm-open"),b.$emit("bgm:unmask"))}),b.$on("bgm:closeall",function(b,c){a.removeClass("bgm-open")}),b.$on("bgm:toggle",function(b,c){c===e&&a.toggleClass("bgm-open")})}function b(){return{scope:!0,controllerAs:"bgmModal",bindToController:{title:"@bgmTitle",bgmId:"@"},restrict:"E",transclude:!0,require:"^bgmModals",templateUrl:"/templates/bgmModal.html",controller:["$element","$rootScope","$transclude","bgModals",a]}}angular.module("bg.modals").directive("bgmModal",b)}(),function(){function a(a,b,c){a.$on("bgm:mask",function(a){b.addClass("bgm-modal-masked")}),a.$on("bgm:unmask",function(a){b.removeClass("bgm-modal-masked")}),a.$on("bgm:closeall",function(a){b.removeClass("bgm-modal-masked")})}function b(){return{scope:!0,bindToController:{},controllerAs:"bgmModals",restrict:"E",transclude:!0,templateUrl:"/templates/bgmModals.html",controller:["$rootScope","$element","$attrs",a]}}angular.module("bg.modals").directive("bgmModals",b)}(),angular.module("bg.modals").factory("bgModals",["$rootScope","$q",function(a,b){function c(c){return a.$emit("bgm:open",c),k[c]=b.defer(),k[c].promise}function d(b){a.$emit("bgm:close",b)}function e(){a.$emit("bgm:closeall")}function f(a,b){d(a),k[a]&&(k[a].resolve(b),delete k[a])}function g(a,b){d(a),k[a]&&(k[a].reject(b),delete k[a])}function h(){k={}}function i(){return"bgm"+j++}var j=0,k={};return a.$on("bgm:rejected",function(a,b,c){k[b]&&(k[b].reject(c),delete k[b])}),a.$on("bgm:accepted",function(a,b,c){k[b].resolve(c),delete k[b]}),{open:c,close:d,closeAll:e,reject:g,accept:f,getId:i,clear:h}}]),angular.module("bg.modals").run(["$templateCache",function(a){"use strict";a.put("/templates/bgmAlert.html",'<div class="bgm-modal bgm-alert"><header><h2>{{bgmAlert.title}}</h2><span ng-click="bgmAlert.close()" class="bgm-btn-close"></span></header><main><ng-transclude></ng-transclude></main><footer><button ng-click="bgmAlert.close()">{{bgmAlert.gotIt}}</button></footer></div>'),a.put("/templates/bgmBody.html","<main><ng-transclude></ng-transclude></main>"),a.put("/templates/bgmButtons.html","<ng-transclude></ng-transclude>"),a.put("/templates/bgmConfirm.html",'<div class="bgm-modal bgm-confirm"><header><h2>{{bgmConfirm.title}}</h2><span ng-click="bgmConfirm.reject()" class="bgm-btn-close"></span></header><main><ng-transclude></ng-transclude></main><footer><button ng-click="bgmConfirm.reject()">{{bgmConfirm.nope}}</button> <button ng-click="bgmConfirm.accept()">{{bgmConfirm.yep}}</button></footer></div>'),a.put("/templates/bgmModal.html",'<header><h2>{{bgmModal.title}}</h2><span ng-click="bgmModal.close()" class="bgm-btn-close"></span></header><main></main>'),a.put("/templates/bgmModals.html",'<div class="bgm-modals"><ng-transclude></ng-transclude><div class="bgm-mask"></div></div>')}]);