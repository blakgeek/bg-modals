angular.module("bg.modals",[]),function(){function a(a,b,c,d){var e=a.inheritedData("$bgmModalsController"),f=this;f.group=e.group,f.id=(f.group?f.group+".":"")+(c.bgmId||d.getId()),this.close=function(){d.accept(f.id)},b.$on("bgm:open",function(c,d){d===f.id&&(a.addClass("bgm-open"),b.$emit("bgm:mask",f.group))}),b.$on("bgm:close",function(c,d){d===f.id&&(a.removeClass("bgm-open"),b.$emit("bgm:unmask",f.group))}),b.$on("bgm:closeall",function(b,c){c&&f.group!==c||a.removeClass("bgm-open")}),b.$on("bgm:toggle",function(b,c){c===f.id&&a.toggleClass("bgm-open")})}function b(){return{scope:!0,controllerAs:"bgmAlert",bindToController:{title:"@bgmTitle",bgmId:"@",gotIt:"@bgmOkText"},restrict:"E",transclude:!0,require:"^bgmModals",templateUrl:"/templates/bgmAlert.html",controller:["$element","$rootScope","$attrs","bgModals",a]}}angular.module("bg.modals").directive("bgmAlert",b)}(),function(){function a(a,b){}function b(){return{scope:{},restrict:"E",transclude:!0,templateUrl:"/templates/bgmButtons.html",controller:["$element","$attrs",a]}}angular.module("bg.modals").directive("bgmButtons",b)}(),function(){function a(a,b,c,d){var e=a.inheritedData("$bgmModalsController"),f=this;f.group=e.group,f.id=(f.group?f.group+".":"")+(c.bgmId||d.getId()),this.reject=function(){d.reject(f.id)},this.accept=function(){d.accept(f.id)},b.$on("bgm:open",function(c,d){d===f.id&&(a.addClass("bgm-open"),b.$emit("bgm:mask",f.group))}),b.$on("bgm:close",function(c,d){d===f.id&&(a.removeClass("bgm-open"),b.$emit("bgm:unmask",f.group))}),b.$on("bgm:closeall",function(b,c){c&&this.group!==c||a.removeClass("bgm-open")}),b.$on("bgm:toggle",function(b,c){c===f.id&&a.toggleClass("bgm-open")})}function b(){return{scope:!0,controllerAs:"bgmConfirm",bindToController:{title:"@bgmTitle",bgmId:"@",yep:"@bgmYepText",nope:"@bgmNopeText"},restrict:"E",transclude:!0,require:"^bgmModals",templateUrl:"/templates/bgmConfirm.html",controller:["$element","$rootScope","$attrs","bgModals",a]}}angular.module("bg.modals").directive("bgmConfirm",b)}(),function(){function a(a,b,c,d,e,f){var g=a.inheritedData("$bgmModalsController"),h=this;h.group=g.group,h.id=(h.group?h.group+".":"")+(c.bgmId||e.getId()),d(function(b){for(var c=a.find("main"),d=0;d<b.length;d++)"BGM-BUTTONS"===b[d].tagName?a.append(b[d]):c.append(b[d])}),this.close=function(){b.$emit("bgm:rejected",h.id),b.$emit("bgm:close",h.id)},b.$on("bgm:open",function(c,d){d===h.id&&(a.addClass("bgm-open"),b.$emit("bgm:mask",h.group))}),b.$on("bgm:close",function(c,d){d===h.id&&(a.removeClass("bgm-open"),b.$emit("bgm:unmask",h.group))}),b.$on("bgm:closeall",function(b,c){c&&h.group!==c||a.removeClass("bgm-open")}),b.$on("bgm:toggle",function(b,c){c===bgmId&&a.toggleClass("bgm-open")})}function b(){return{scope:!0,controllerAs:"bgmModal",bindToController:{title:"@bgmTitle"},restrict:"E",transclude:!0,require:"^bgmModals",templateUrl:"/templates/bgmModal.html",controller:["$element","$rootScope","$attrs","$transclude","bgModals",a]}}angular.module("bg.modals").directive("bgmModal",b)}(),function(){function a(a,b,c){var d=this;a.$on("bgm:mask",function(a,c){d.group===c&&b.addClass("bgm-modal-masked")}),a.$on("bgm:unmask",function(a,c){d.group===c&&b.removeClass("bgm-modal-masked")}),a.$on("bgm:closeall",function(a,c){c&&d.group!==c||b.removeClass("bgm-modal-masked")})}function b(){return{scope:!0,bindToController:{group:"@bgmGroup"},controllerAs:"bgmModals",restrict:"E",transclude:!0,templateUrl:"/templates/bgmModals.html",controller:["$rootScope","$element","$attrs",a]}}angular.module("bg.modals").directive("bgmModals",b)}(),function(){angular.module("bg.modals").factory("bgModals",["$rootScope","$q",function(a,b){function c(c){return a.$emit("bgm:open",c),k[c]=b.defer(),k[c].promise}function d(b){a.$emit("bgm:close",b)}function e(b){a.$emit("bgm:closeall",b)}function f(a,b){d(a),k[a]&&(k[a].resolve(b),delete k[a])}function g(a,b){d(a),k[a]&&(k[a].reject(b),delete k[a])}function h(){k={}}function i(){return"bgm"+j++}var j=0,k={};return a.$on("bgm:rejected",function(a,b,c){k[b]&&(k[b].reject(c),delete k[b])}),a.$on("bgm:accepted",function(a,b,c){k[b].resolve(c),delete k[b]}),{open:c,close:d,closeAll:e,reject:g,accept:f,getId:i,clear:h}}])}(),angular.module("bg.modals").run(["$templateCache",function(a){"use strict";a.put("/templates/bgmAlert.html",'<div class="bgm-modal bgm-alert"><header><h2>{{bgmAlert.title}}</h2><span ng-click="bgmAlert.close()" class="bgm-btn-close"></span></header><main><ng-transclude></ng-transclude></main><footer><button ng-click="bgmAlert.close()">{{bgmAlert.gotIt}}</button></footer></div>'),a.put("/templates/bgmBody.html","<main><ng-transclude></ng-transclude></main>"),a.put("/templates/bgmButtons.html","<ng-transclude></ng-transclude>"),a.put("/templates/bgmConfirm.html",'<div class="bgm-modal bgm-confirm"><header><h2>{{bgmConfirm.title}}</h2><span ng-click="bgmConfirm.reject()" class="bgm-btn-close"></span></header><main><ng-transclude></ng-transclude></main><footer><button ng-click="bgmConfirm.reject()">{{bgmConfirm.nope}}</button> <button ng-click="bgmConfirm.accept()">{{bgmConfirm.yep}}</button></footer></div>'),a.put("/templates/bgmModal.html",'<header><h2>{{bgmModal.title}}</h2><span ng-click="bgmModal.close()" class="bgm-btn-close"></span></header><main></main>'),a.put("/templates/bgmModals.html",'<div class="bgm-modals"><ng-transclude></ng-transclude><div class="bgm-mask"></div></div>')}]);